(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{PQMj:function(e,t,a){e.exports={"ant-badge":"ant-badge","ant-badge-count":"ant-badge-count","ant-badge-multiple-words":"ant-badge-multiple-words","ant-badge-dot":"ant-badge-dot","ant-scroll-number-custom-component":"ant-scroll-number-custom-component","ant-badge-status":"ant-badge-status","ant-badge-status-dot":"ant-badge-status-dot","ant-badge-status-success":"ant-badge-status-success","ant-badge-status-processing":"ant-badge-status-processing",antStatusProcessing:"antStatusProcessing","ant-badge-status-default":"ant-badge-status-default","ant-badge-status-error":"ant-badge-status-error","ant-badge-status-warning":"ant-badge-status-warning","ant-badge-status-pink":"ant-badge-status-pink","ant-badge-status-magenta":"ant-badge-status-magenta","ant-badge-status-red":"ant-badge-status-red","ant-badge-status-volcano":"ant-badge-status-volcano","ant-badge-status-orange":"ant-badge-status-orange","ant-badge-status-yellow":"ant-badge-status-yellow","ant-badge-status-gold":"ant-badge-status-gold","ant-badge-status-cyan":"ant-badge-status-cyan","ant-badge-status-lime":"ant-badge-status-lime","ant-badge-status-green":"ant-badge-status-green","ant-badge-status-blue":"ant-badge-status-blue","ant-badge-status-geekblue":"ant-badge-status-geekblue","ant-badge-status-purple":"ant-badge-status-purple","ant-badge-status-text":"ant-badge-status-text","ant-badge-zoom-appear":"ant-badge-zoom-appear","ant-badge-zoom-enter":"ant-badge-zoom-enter",antZoomBadgeIn:"antZoomBadgeIn","ant-badge-zoom-leave":"ant-badge-zoom-leave",antZoomBadgeOut:"antZoomBadgeOut","ant-badge-not-a-wrapper":"ant-badge-not-a-wrapper","ant-scroll-number":"ant-scroll-number","ant-scroll-number-only":"ant-scroll-number-only","ant-scroll-number-symbol":"ant-scroll-number-symbol"}},d4Yg:function(e,t,a){"use strict";a.r(t);a("g9YV");var n=a("wCAj"),r=(a("2qtc"),a("kLXV")),o=(a("IzEo"),a("bx4M")),s=(a("14J3"),a("BMrR")),l=(a("Pwec"),a("CtXQ")),c=(a("cIOH"),a("PQMj"),a("q1tI")),u=a.n(c),i=a("17x9"),d=a("MFj2"),m=a("BGR+"),p=a("TSYQ"),f=a.n(p),b=a("VCL8"),g=a("wEI+");function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function v(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function E(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e){return e?e.toString().split("").reverse().map(function(e){var t=Number(e);return isNaN(t)?e:t}):[]}var k=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=E(this,N(t).call(this,e))).onAnimated=function(){var e=a.props.onAnimated;e&&e()},a.renderScrollNumber=function(e){var t=e.getPrefixCls,n=a.props,r=n.prefixCls,o=n.className,s=n.style,l=n.title,u=n.component,i=void 0===u?"sup":u,d=n.displayComponent,p=Object(m.default)(a.props,["count","onAnimated","component","prefixCls","displayComponent"]),b=t("scroll-number",r),g=h(h({},p),{className:f()(b,o),title:l});return s&&s.borderColor&&(g.style=h(h({},s),{boxShadow:"0 0 0 1px ".concat(s.borderColor," inset")})),d?c.cloneElement(d,{className:f()("".concat(b,"-custom-component"),d.props&&d.props.className)}):c.createElement(i,g,a.renderNumberElement(b))},a.state={animateStarted:!0,count:e.count},a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,c["Component"]),a=t,r=[{key:"getDerivedStateFromProps",value:function(e,t){return"count"in e?t.count===e.count?null:{animateStarted:!0}:null}}],(n=[{key:"componentDidUpdate",value:function(e,t){this.lastCount=t.count,this.state.animateStarted&&this.setState(function(e,t){return{animateStarted:!1,count:t.count}},this.onAnimated)}},{key:"getPositionByNum",value:function(e,t){var a=this.state.count,n=Math.abs(Number(a)),r=Math.abs(Number(this.lastCount)),o=Math.abs(C(this.state.count)[t]),s=Math.abs(C(this.lastCount)[t]);return this.state.animateStarted?10+e:n>r?o>=s?10+e:20+e:o<=s?10+e:e}},{key:"renderCurrentNumber",value:function(e,t,a){if("number"==typeof t){var n=this.getPositionByNum(t,a),r=this.state.animateStarted||void 0===C(this.lastCount)[a];return c.createElement("span",{className:"".concat(e,"-only"),style:{transition:r?"none":void 0,msTransform:"translateY(".concat(100*-n,"%)"),WebkitTransform:"translateY(".concat(100*-n,"%)"),transform:"translateY(".concat(100*-n,"%)")},key:a},function(e){for(var t=[],a=0;a<30;a++){var n=e===a?"current":"";t.push(c.createElement("p",{key:a.toString(),className:n},a%10))}return t}(n))}return c.createElement("span",{key:"symbol",className:"".concat(e,"-symbol")},t)}},{key:"renderNumberElement",value:function(e){var t=this,a=this.state.count;return a&&Number(a)%1==0?C(a).map(function(a,n){return t.renderCurrentNumber(e,a,n)}).reverse():a}},{key:"render",value:function(){return c.createElement(g.a,null,this.renderScrollNumber)}}])&&v(a.prototype,n),r&&v(a,r),t}();k.defaultProps={count:null,onAnimated:function(){}},Object(b.polyfill)(k);var x=k,S=a("09Wf");function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function j(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function B(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function D(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var M=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(a[n[r]]=e[n[r]])}return a};function A(e){return-1!==S.a.indexOf(e)}var L=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=D(this,I(t).apply(this,arguments))).renderBadge=function(t){var a,n=t.getPrefixCls,r=e.props,o=r.prefixCls,s=r.scrollNumberPrefixCls,l=r.children,u=r.status,i=r.text,p=r.color,b=M(r,["prefixCls","scrollNumberPrefixCls","children","status","text","color"]),g=["count","showZero","overflowCount","className","style","dot","offset","title"],y=n("badge",o),h=n("scroll-number",s),v=e.renderBadgeNumber(y,h),E=e.renderStatusText(y),N=f()((j(a={},"".concat(y,"-status-dot"),e.hasStatus()),j(a,"".concat(y,"-status-").concat(u),!!u),j(a,"".concat(y,"-status-").concat(p),A(p)),a)),w={};if(p&&!A(p)&&(w.background=p),!l&&e.hasStatus()){var C=e.getStyleWithOffset(),k=C&&C.color;return c.createElement("span",P({},Object(m.default)(b,g),{className:e.getBadgeClassName(y),style:C}),c.createElement("span",{className:N,style:w}),c.createElement("span",{style:{color:k},className:"".concat(y,"-status-text")},i))}return c.createElement("span",P({},Object(m.default)(b,g),{className:e.getBadgeClassName(y)}),l,c.createElement(d.a,{component:"",showProp:"data-show",transitionName:l?"".concat(y,"-zoom"):"",transitionAppear:!0},v),E)},e}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(t,c["Component"]),a=t,(n=[{key:"getNumberedDispayCount",value:function(){var e=this.props,t=e.count,a=e.overflowCount;return t>a?"".concat(a,"+"):t}},{key:"getDispayCount",value:function(){return this.isDot()?"":this.getNumberedDispayCount()}},{key:"getScrollNumberTitle",value:function(){var e=this.props,t=e.title,a=e.count;return t||("string"==typeof a||"number"==typeof a?a:void 0)}},{key:"getStyleWithOffset",value:function(){var e=this.props,t=e.offset,a=e.style;return t?P({right:-parseInt(t[0],10),marginTop:t[1]},a):a}},{key:"getBadgeClassName",value:function(e){var t,a=this.props,n=a.className,r=a.children;return f()(n,e,(j(t={},"".concat(e,"-status"),this.hasStatus()),j(t,"".concat(e,"-not-a-wrapper"),!r),t))}},{key:"hasStatus",value:function(){var e=this.props,t=e.status,a=e.color;return!!t||!!a}},{key:"isZero",value:function(){var e=this.getNumberedDispayCount();return"0"===e||0===e}},{key:"isDot",value:function(){var e=this.props.dot,t=this.isZero();return e&&!t||this.hasStatus()}},{key:"isHidden",value:function(){var e=this.props.showZero,t=this.getDispayCount(),a=this.isZero(),n=this.isDot();return(null===t||void 0===t||""===t||a&&!e)&&!n}},{key:"renderStatusText",value:function(e){var t=this.props.text;return this.isHidden()||!t?null:c.createElement("span",{className:"".concat(e,"-status-text")},t)}},{key:"renderDispayComponent",value:function(){var e=this.props.count;if(e&&"object"===O(e))return c.cloneElement(e,{style:P(P({},this.getStyleWithOffset()),e.props&&e.props.style)})}},{key:"renderBadgeNumber",value:function(e,t){var a,n=this.props,r=n.status,o=n.count,s=this.getDispayCount(),l=this.isDot(),u=this.isHidden(),i=f()((j(a={},"".concat(e,"-dot"),l),j(a,"".concat(e,"-count"),!l),j(a,"".concat(e,"-multiple-words"),!l&&o&&o.toString&&o.toString().length>1),j(a,"".concat(e,"-status-").concat(r),this.hasStatus()),a));return u?null:c.createElement(x,{prefixCls:t,"data-show":!u,className:i,count:s,displayComponent:this.renderDispayComponent(),title:this.getScrollNumberTitle(),style:this.getStyleWithOffset(),key:"scrollNumber"})}},{key:"render",value:function(){return c.createElement(g.a,null,this.renderBadge)}}])&&B(a.prototype,n),r&&B(a,r),t}();L.defaultProps={count:null,showZero:!1,dot:!1,overflowCount:99},L.propTypes={count:i.node,showZero:i.bool,dot:i.bool,overflowCount:i.number};a("jCWc");var z=a("kPKH"),_=a("p0pE"),F=a.n(_),H=a("d6i3"),Z=a.n(H),W=a("1l/V"),R=a.n(W),G=a("2Taf"),Y=a.n(G),q=a("vZ4D"),Q=a.n(q),U=a("l4Ni"),V=a.n(U),J=a("ujKo"),X=a.n(J),K=a("MhPg"),$=a.n(K),ee=(a("tU7J"),a("wFql")),te=a("y1Nh"),ae=a("XfOM"),ne=a.n(ae),re=a("yP6+"),oe=a("cQSq"),se=a.n(oe),le=a("t/q1"),ce=a("iJd5"),ue=a("+n12"),ie=se.a.DataView,de=re.Guide.Html,me=(ee.a.Paragraph,ee.a.Text),pe=function(e){function t(e){var a;return Y()(this,t),(a=V()(this,X()(t).call(this,e))).onFetchDetail=R()(Z.a.mark(function e(){var t,n;return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.clusterId,e.next=3,le.a.getClusterDetail({clusterId:t});case 3:(n=e.sent)&&"1"==n.code&&a.setState({detail:n.data||{}});case 5:case"end":return e.stop()}},e)})),a.onFetchNodeData=R()(Z.a.mark(function e(){var t,n,r,o=arguments;return Z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},n=a.state.clusterId,a.setState({nodeListLoading:!0}),e.next=5,le.a.getClusterNodePage(F()({},t,{clusterId:n}));case 5:r=e.sent,a.setState({nodeList:r.data||{},nodeListLoading:!1});case 7:case"end":return e.stop()}},e)})),a.onDownOff=function(e){},a.onNodeReload=function(){a.onFetchNodeData()},a.onNodeTableChange=function(e,t,n){var r=e.current,o=e.pageSize;a.onFetchNodeData({pageNo:r,pageSize:o})},a.showAddNode=function(){a.setState({showAddNode:!0})},a.onAddModalCancel=function(){a.setState({showAddNode:!1})},a.onHref=function(e){window.open("http://".concat(e))},a.state={clusterId:"",detail:{},nodeList:{},nodeListLoading:!1,showAddNode:!1},a}return $()(t,e),Q()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.location.query||{};t.clusterId&&this.setState({clusterId:t.clusterId},function(){e.onFetchDetail(),e.onFetchNodeData()})}},{key:"renderChart",value:function(e,t,a,n,r,o){var s=this.state.detail;t.source(e).transform({type:"percent",field:a,dimension:"name",as:"percent"});return u.a.createElement("div",null,u.a.createElement(re.Chart,{height:300,data:t,scale:{percent:{formatter:function(e){return e=(100*e).toFixed(2)+"%"}},id:{formatter:function(e){return e||""}}},padding:[50,150,50,50],forceFit:!0},u.a.createElement(re.Coord,{type:"theta",radius:1,innerRadius:.6}),u.a.createElement(re.Axis,{name:"percent"}),u.a.createElement(re.Tooltip,{showTitle:!1,itemTpl:'<li><span style="background-color:{color};" class="g2-tooltip-marker"></span>{name}: {value}</li>'}),u.a.createElement(re.Guide,null,u.a.createElement(de,{position:["50%","50%"],html:'<div style="color:#333;font-size:20px;text-align: center;width: 10em">'.concat(n,'<br><span style="color:#262626;font-size:14px">').concat("cpu"!==r?Object(ue.a)(s[r]):s[r]," ").concat(o,"</span></div>"),alignX:"middle",alignY:"middle"})),u.a.createElement(re.Geom,{type:"intervalStack",position:"percent",color:["id",function(e){if(!e)return"#999999"}],tooltip:["name*percent",function(e,t){return t=(100*t).toFixed(2)+"%",{name:e||"未使用",value:t}}],style:{lineWidth:1,stroke:"#fff"}},u.a.createElement(re.Label,{content:"percent",formatter:function(e,t){return(t.point.name?t.point.name:"未使用")+": "+e}}))))}},{key:"renderBasic",value:function(){var e=this,t=this.state.detail;return u.a.createElement(o.a,{title:"集群基础信息",className:ne.a.marginB},u.a.createElement(s.a,{type:"flex",align:"top"},u.a.createElement(z.a,{md:6},u.a.createElement("div",{className:ne.a.flex},u.a.createElement("p",{className:ne.a.textBlack},"命名："),u.a.createElement("p",null,t.name))),u.a.createElement(z.a,{md:6},u.a.createElement("div",{className:ne.a.flex},u.a.createElement("p",{className:ne.a.textBlack},"类型："),u.a.createElement("p",null,t.type&&ce.d[t.type]?ce.d[t.type]:""))),u.a.createElement(z.a,{md:12},u.a.createElement("div",{className:ne.a.flex},u.a.createElement("p",{className:ne.a.textBlack},"集群master："),u.a.createElement("p",null,t.marathons&&t.marathons.map(function(a,n){return u.a.createElement(c.Fragment,{key:n},a.status&&ce.c[a.status]&&u.a.createElement(L,{status:ce.c[a.status].type}),u.a.createElement("a",{onClick:function(){return e.onHref(a.url)}},a.url),n!==t.marathons.length-1&&u.a.createElement("span",null," | "))})))),u.a.createElement(z.a,{md:6},u.a.createElement("div",{className:ne.a.flex},u.a.createElement("p",{className:ne.a.textBlack},"状态："),u.a.createElement("p",null,t.status&&ce.c[t.status]&&u.a.createElement(c.Fragment,null,u.a.createElement(l.a,{type:ce.c[t.status].icon,style:{fontSize:25,color:ce.c[t.status].colorValue}}))))),u.a.createElement(z.a,{md:6},u.a.createElement("div",{className:ne.a.flex},u.a.createElement("p",{className:ne.a.textBlack},"DC/OS版本："),u.a.createElement("p",null,t.version))),u.a.createElement(z.a,{md:12},u.a.createElement("div",{className:ne.a.flex},u.a.createElement("p",{className:ne.a.textBlack},"集群LB详情："),u.a.createElement("div",null,t.mlbs&&t.mlbs.map(function(t,a){return u.a.createElement("p",{key:a},t.status&&ce.c[t.status]&&u.a.createElement(L,{status:ce.c[t.status].type}),u.a.createElement("a",{onClick:function(){return e.onHref(t.url+":9090/haproxy?stats")}},t.url+":9090/haproxy?stats"))})))),u.a.createElement(z.a,{md:12,push:12},u.a.createElement("div",{className:ne.a.flex},u.a.createElement("p",{className:ne.a.textBlack},"镜像库："),u.a.createElement("div",null,t.dockerHubs&&t.dockerHubs.map(function(t,a){return u.a.createElement("p",{key:a},t.status&&ce.c[t.status]&&u.a.createElement(L,{status:ce.c[t.status].type}),u.a.createElement("a",{onClick:function(){return e.onHref(t.url)}},t.url))}))))))}},{key:"renderUseInfo",value:function(){var e=this.state.detail,t=new ie,a=new ie,n=new ie,r=e.envResources||[];return u.a.createElement(o.a,{title:"使用情况",className:ne.a.marginB},u.a.createElement(s.a,null,u.a.createElement(z.a,{md:8,sm:24},this.renderChart(r,t,"cpus","CPU","cpu","Core")),u.a.createElement(z.a,{md:8,sm:24},this.renderChart(r,a,"memory","内存","memory","GiB")),u.a.createElement(z.a,{md:8,sm:24},this.renderChart(r,n,"disk","磁盘","disk","GiB"))))}},{key:"renderAddNodeModal",value:function(){var e=this.state.showAddNode;return u.a.createElement(r.a,{visible:e,title:"新增节点",footer:null,onCancel:this.onAddModalCancel},u.a.createElement("p",null,"请在需要加入DC/OS集群的节点上",u.a.createElement("span",null,"安装Docker"),"之后，运行以下新增节点命令"),u.a.createElement(s.a,{type:"flex",justify:"space-between",align:"middle",className:ne.a.copyBg},u.a.createElement(z.a,{span:20},u.a.createElement(me,{className:ne.a.colorWhite},"curl -sSL https://ata.cloud.local.com/shells/install.sh | sh -s cd4f4bdd8d7d7cde0e")),u.a.createElement(z.a,null,u.a.createElement(me,{copyable:{text:"curl -sSL https://ata.cloud.local.com/shells/install.sh | sh -s cd4f4bdd8d7d7cde0e"}}))))}},{key:"renderNode",value:function(){var e=this.state,t=e.nodeList,a=e.nodeListLoading,r=(e.showAddNode,[{title:"IP",dataIndex:"ip"},{title:"节点类型",dataIndex:"nodeType"},{title:"健康状态",dataIndex:"status",render:function(e,t){return u.a.createElement("span",null,u.a.createElement(L,{status:"0"===e?"success":"-1"===e?"default":"error"}))}},{title:"容器",dataIndex:"containerQuantity"},{title:"CPU",dataIndex:"cpu",render:function(e,t){return u.a.createElement("span",null,"".concat(t.usedCpu,"/").concat(e," (").concat(Math.round(t.usedCpu/e*100),"%)"))}},{title:"内存",dataIndex:"memory",render:function(e,t){return u.a.createElement("span",null,"".concat(Object(ue.a)(t.usedMemory),"/").concat(Object(ue.a)(e)," GiB (").concat(Math.round(t.usedMemory/e*100),"%)"))}},{title:"磁盘",dataIndex:"disk",render:function(e,t){return u.a.createElement("span",null,"".concat(Object(ue.a)(t.usedDisk),"/").concat(Object(ue.a)(e)," GiB (").concat(Math.round(t.usedDisk/e*100),"%)"))}}]);return u.a.createElement(o.a,{title:u.a.createElement("div",null,u.a.createElement("span",{className:ne.a.marginR},"节点"),u.a.createElement(l.a,{type:"reload",onClick:this.onNodeReload}))},u.a.createElement(n.a,{columns:r,dataSource:t.rows||[],onChange:this.onNodeTableChange,loading:a,pagination:{total:t.totalCount||0,showTotal:function(e,a){return"共".concat(t.totalCount||0,"条，当前").concat(t.pageNum?t.pageNum:1,"/").concat(t.totalPage?t.totalPage:1,"页")},current:t.pageNum?t.pageNum:1,pageSize:t.pageSize?t.pageSize:10},rowKey:function(e){return e.id}}))}},{key:"render",value:function(){var e=this.state.detail;return u.a.createElement(c.Fragment,null,e.clusterId&&u.a.createElement(te.PageHeaderWrapper,{title:e.name},this.renderBasic(),this.renderUseInfo(),this.renderNode()))}}]),t}(u.a.Component);t.default=pe}}]);