## 创建服务发布配置
> 基于服务详情页是根据服务所在环境进行展示的，所以创建发布配置也是针对当前所在环境。

### 新建发布配置-构建发布
> 构建发布指的是发布时拉取源代码进行编译构建、打镜像、发布。

1. 基本信息  
    - 填写发布配置的名称和描述信息，确认发布配置的所属环境和发布类型。

2. 编译构建（代码编译、打镜像）
    - 确认代码库地址：创建服务时设定
    - 可设置发布时可选代码分支：如生产环境发布，仅允许发布master分支
    - 代码编译命令：可以是maven、npm等代码编译命令，如不需要编译可不填
    - 镜像名：固定格式（服务所属项目CODE/服务CODE）
    - Dockerfile 文件路径：Dockerfile 文件在代码仓库中的相对路径

3. 容器运行（容器运行配置）
    - 启动命令：填写服务的启动命令，如不需要可空
    - 容器资源：单个容器实例所分配的CPU、内存资源
    - 容器个数：默认启动容器实例的个数（扩缩容功能中可动态调整实例个数）
    - 服务端口：可配置容器端口提供集群外访问，类似于将 -p 传递到 Docker 命令行，以指定Marathon-LB上端口与容器内的端口之间的关系。在服务的运行情况页会展示当前服务的端口访问情况
    - LB分配端口：当容器端口提供集群外访问时，会自动分配一个LB端口。

4. 额外设置
    - 环境变量：设置容器的环境变量
    
    - 持久化挂载卷：容器重启或者漂移时，本地文件将会丢失，可以使用挂载卷以持久化保存本地文件
    
    - 健康检查：为服务定义运行状况检查。运行状况检查会对容器执行定期检查，以确保它们已启动并响应。如果运行状况检查因任何原因失败，会将该任务报告为运行状况不佳，以便状态感知负载均衡器可以停止向容器发送流量。任务达到最大连续失败次数后，将终止该任务并重新启动。
  


### 新建发布配置-镜像发布
> 相对于构建发布，镜像发布过程更加简单，可以选择已有镜像直接发布（无需拉取源代码编译构建、打镜像）。

创建过程同构建发布（不需要编译构建步骤）。


### 新建发布配置-导入配置
> 选择当前服务已有的发布配置进行修改后保存为新的发布配置，避免重复填写相同的表单项。


#### 下一步·[服务发布](./app_deploy.md)